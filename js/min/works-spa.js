let worksData={},worksOrder=[],currentSwiper=null;const GLITCH_CHARS="01@#$%&*[]{}01010101><~^+=?/\\|";function animateTextGlitch(t,e,n=800){if(!t)return;const o=t.textContent||"",r=Math.max(o.length,e.length),i=performance.now(),a=Array.from({length:r},()=>.5*Math.random());requestAnimationFrame(function o(s){const l=s-i,c=Math.min(l/n,1);let d="";for(let t=0;t<r;t++){const n=Math.min(Math.max((c-a[t])/.5,0),1);n<1&&Math.random()>n?d+=GLITCH_CHARS[Math.floor(30*Math.random())]:d+=e[t]||""}t.textContent=d,c<1?requestAnimationFrame(o):t.textContent=e})}function animateTextTypewriter(t,e,n=800,o=!1){if(!t)return;const r=performance.now(),i=o?e:e.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim();requestAnimationFrame(function a(s){const l=s-r,c=Math.min(l/n,1),d=Math.floor(i.length*c);o?t.innerHTML=i.substring(0,d)+(c<1?'<span class="typing-cursor">▌</span>':""):t.textContent=i.substring(0,d)+(c<1?"▌":""),c<1?requestAnimationFrame(a):o?t.innerHTML=e:t.textContent=i})}function animateTextTransition(t,e,n="glitch",o=800){"typewriter"===n?animateTextTypewriter(t,e,o):animateTextGlitch(t,e,o)}function showLoadingSpinner(){const t=document.getElementById("loading-spinner");t&&(t.style.display="block")}function hideLoadingSpinner(){const t=document.getElementById("loading-spinner");t&&(t.style.display="none")}function updateMetaTags(t){document.title=`${t.title} - Ryo Simon`;let e=document.querySelector('meta[name="description"]');if(e&&t.description){const n=t.description.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim(),o=n.substring(0,155)+(n.length>155?"...":"");e.setAttribute("content",o)}let n=document.querySelector('meta[property="og:title"]');n&&n.setAttribute("content",`${t.title} - Ryo Simon`);let o=document.querySelector('meta[property="og:description"]');if(o&&t.description){const e=t.description.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim(),n=e.substring(0,155)+(e.length>155?"...":"");o.setAttribute("content",n)}let r=document.querySelector('meta[property="og:image"]');if(r&&t.thumbnail){const e="https://ryo-simon-mf.github.io",n=t.thumbnail.startsWith("http")?t.thumbnail:`${e}/works/${t.thumbnail}`;r.setAttribute("content",n)}let i=document.querySelector('meta[property="og:url"]');i&&i.setAttribute("content",`https://ryo-simon-mf.github.io/works/works.html#${t.id}`),addStructuredData(t)}function addStructuredData(t){removeStructuredData();const e={"@context":"https://schema.org","@type":"CreativeWork",name:t.title,creator:{"@type":"Person",name:"Ryo Simon",alternateName:"Ryo Nishikado",url:"https://ryo-simon-mf.github.io"},dateCreated:t.year,description:t.description?t.description.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim():"",image:t.thumbnail?`https://ryo-simon-mf.github.io/works/${t.thumbnail}`:"",url:`https://ryo-simon-mf.github.io/works/works.html#${t.id}`,keywords:[t.category,"interactive art","creative coding","media art"],genre:t.category};t.tools&&(e.tool=t.tools.replace(/<[^>]*>/g," ").trim()),t.award&&(e.award=t.award.replace(/<[^>]*>/g," ").trim());const n=document.createElement("script");n.type="application/ld+json",n.id="work-structured-data",n.text=JSON.stringify(e,null,2),document.head.appendChild(n)}function removeStructuredData(){const t=document.getElementById("work-structured-data");t&&t.remove()}function resetMetaTags(){document.title="Works - Ryo Simon",removeStructuredData();let t=document.querySelector('meta[name="description"]');t&&t.setAttribute("content","Works project by Ryo Simon.");let e=document.querySelector('meta[property="og:title"]');e&&e.setAttribute("content","Works - Ryo Simon");let n=document.querySelector('meta[property="og:description"]');n&&n.setAttribute("content","Works project by Ryo Simon.");let o=document.querySelector('meta[property="og:image"]');o&&o.setAttribute("content","https://ryo-simon-mf.github.io/image/profile/2025_icon_basic.png");let r=document.querySelector('meta[property="og:url"]');r&&r.setAttribute("content","https://ryo-simon-mf.github.io/works/works.html")}async function initWorksSPA(){try{const t=await fetch("../works-data/index.json"),e=await t.json();e.works?(worksOrder=e.works.map(t=>t.id),addMetadataToThumbnails(e.works)):worksOrder=e.order,window.addEventListener("hashchange",handleHashChange),await handleHashChange(),document.querySelectorAll(".img_wrap a").forEach(t=>{t.addEventListener("click",function(t){t.preventDefault();const e=extractWorkId(this.getAttribute("href"));window.location.hash=e})})}catch(t){console.error("Failed to initialize Works SPA:",t)}}function addMetadataToThumbnails(t){t.forEach(t=>{document.querySelectorAll(".img_wrap a").forEach(e=>{if(extractWorkId(e.getAttribute("href"))===t.id){const n=e.closest(".img_wrap");n&&(n.setAttribute("data-year",t.year),n.setAttribute("data-title",t.title),n.setAttribute("data-category",t.category))}})})}async function loadWork(t){if(worksData[t])return worksData[t];try{const e=await fetch(`../works-data/${t}.json`);if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const n=await e.json();return worksData[t]=n,n}catch(e){return console.error(`Failed to load ${t}.json:`,e),null}}function extractWorkId(t){const e=t.replace("./","");return{"toki-shirube.html":"toki-shirube","inochinokodou.html":"inochinokodou","muses_ex_echoes.html":"muses-ex-echoes","improvise_chain.html":"improvise-chain","theplot_echo_mv.html":"theplot-echo-mv","VariableFlavorRemix.html":"variable-flavor-remix","AdaptiveYantra.html":"adaptive-yantra","HapticGuidingSuite.html":"haptic-guiding-suite","AiTellYouDjing.html":"ai-tell-you-djing","Morse_Code.html":"morse-code","mutek_jp_2020.html":"mutek-jp-2020","playingtokyo_vol11.html":"playingtokyo-vol11","solgasa_nextup_animation.html":"solgasa-nextup-animation","tSA.html":"t-s-a","xMusicOnline0418.html":"x-music-online0418","onlineb2b_proto.html":"onlineb2b-proto","SequencingOfFutureConversation.html":"sequencing-of-future-conversation","Text2Sequence.html":"text2-sequence","ZigSow.html":"zig-sow","Motion-Crossfader.html":"motion-crossfader","shikael.html":"shikael","OriginalLogo.html":"original-logo","sanskritlogo.html":"sanskritlogo","Toilecher.html":"toilecher","rfont.html":"rfont","randb.html":"randb","cfv.html":"cfv","jpdd.html":"jpdd","eyehaveyou.html":"eyehaveyou","pourwater.html":"pourwater","colorboxes.html":"colorboxes"}[e]||e.replace(".html","")}async function handleHashChange(){const t=window.location.hash.slice(1);if(t){showLoadingSpinner();const e=await loadWork(t);hideLoadingSpinner(),e?showWorkDetail(t):showWorksList()}else showWorksList()}function showWorksList(){const t=document.querySelector(".center-container"),e=document.getElementById("content"),n=document.getElementById("work-detail-view");if(n){const t=n.querySelector(".swiper-container"),e=n.querySelector("#content_in"),r=n.querySelector("h3"),i=n.querySelector(".fixed-header-area"),a=Array.from(n.querySelectorAll("hr")).filter(t=>!i||!i.contains(t));t&&(t.style.transition="opacity 0.4s ease",t.style.opacity="0"),e&&(e.style.transition="opacity 0.4s ease",e.style.opacity="0"),r&&(r.style.transition="opacity 0.4s ease",r.style.opacity="0"),a.forEach(t=>{t.style.transition="opacity 0.4s ease",t.style.opacity="0"}),setTimeout(()=>{o()},400)}else o();function o(){resetMetaTags(),n&&n.remove();e.querySelectorAll(":scope > br, :scope > h1, :scope > hr, :scope > p").forEach(t=>{t.style.display="block"});const o=e.querySelector("h1");o&&animateTextTransition(o,"Works","glitch",600);const r=e.querySelector("p");if(r){const t=r.querySelectorAll(".filter-btn"),e=["All","Code","Object","Design"];t.forEach((t,n)=>{const o=e[n],r="01@#$%&*[]{}><~^+=?/\\|";let i="";for(let t=0;t<o.length;t++)i+=r[Math.floor(22*Math.random())];t.textContent=i,setTimeout(()=>{animateTextGlitch(t,o,400)},100+50*n)})}const i=e.querySelector("#filter-count");if(i){const t=document.querySelector(".filter-btn.active"),e=t?t.getAttribute("data-filter"):"all",n=document.querySelectorAll(".img_wrap");let o=0;"all"===e?o=n.length:n.forEach(t=>{t.getAttribute("data-category")===e&&o++});const r=` [${o} ${1===o?"work":"works"}]`,a="01@#$%&*[]{}><~^+=?/\\|";let s="";for(let t=0;t<r.length;t++)s+=a[Math.floor(Math.random()*a.length)];i.textContent=s,setTimeout(()=>{animateTextTransition(i,r,"glitch",400)},300)}t&&(t.style.display="block");const a=document.querySelector(".filter-btn.active"),s=a?a.getAttribute("data-filter"):"all",l=[];document.querySelectorAll(".img_wrap").forEach(t=>{if("all"===s)t.style.display="inline-block",l.push(t);else{t.getAttribute("data-category")===s?(t.style.display="inline-block",l.push(t)):t.style.display="none"}t.style.opacity="0",t.style.transition="opacity 0.4s ease",t.style.willChange="opacity"}),window.reinitLazyLoad&&window.reinitLazyLoad(),l.forEach((t,e)=>{setTimeout(()=>{t.style.opacity="1",setTimeout(()=>{t.style.willChange="auto"},400)},100+30*e)}),currentSwiper&&(currentSwiper.destroy(!0,!0),currentSwiper=null)}}function showWorkDetail(t){const e=worksData[t],n=document.getElementById("content"),o=document.querySelector(".center-container");updateMetaTags(e);const r=document.querySelectorAll(".img_wrap");r.forEach(t=>{t.style.transition="opacity 0.4s ease",t.style.opacity="0"}),setTimeout(()=>{n.querySelectorAll(":scope > br, :scope > h1, :scope > hr, :scope > p").forEach(t=>{t.style.display="none"}),o&&(o.style.display="none"),r.forEach(t=>{t.style.display="none"}),createDetailView(e,t)},400)}function createDetailView(t,e){const n=document.getElementById("content"),o=document.getElementById("work-detail-view");o&&o.remove();const r=document.createElement("div");r.id="work-detail-view";const i=t.images.map(t=>`\n                    <div class="swiper-slide">\n                        <div class="img_w2">\n                            <img src="${t}" alt="" loading="lazy">\n                        </div>\n                    </div>`).join("");r.innerHTML=DOMPurify.sanitize(`\n            \x3c!-- Fixed Header Area --\x3e\n            <div class="fixed-header-area">\n                <h1>\n                    \x3c!-- Heading　--\x3e\n                    <span class="work-title-animated">Works</span>\n                    <a href="#" class="back-to-list">Back to Works</a>\n                </h1>\n                <hr>\n                <p class="work-header-metadata">\n                    <span class="list work-year-animated">----</span> | <span class="list work-category-animated">----</span>\n                </p>\n            </div>\n\n            <div class="swiper-container" style="opacity: 0;">\n                <div class="swiper-wrapper">\n${i}\n                </div>\n                <div class="swiper-button-prev"></div>\n                <div class="swiper-button-next"></div>\n            </div>\n            <hr>\n\n            \x3c!-- Subheading　--\x3e\n            <h3>\n                ${t.title}\n            </h3>\n            <div id="content_in" class="work-content-animated">\n                ${t.description?`<p>\n                    ${t.description}\n                </p>`:""}\n\n                <dl>\n                ${t.performers?`\n                <dt>Performers</dt>\n                <dd>\n                    ${t.performers}\n                </dd>\n                <br>`:""}\n                ${t.credit?`<dt>Credit</dt>\n                <dd>\n                    ${t.credit}\n                </dd>\n                <br>`:""}\n                ${t.tools?`<dt>Tool</dt>\n                <dd>\n                    ${t.tools}\n                </dd>\n                <br>`:""}\n                ${t.exhibition?`<dt>Exhibition</dt>\n                <dd>\n                    ${t.exhibition}\n                </dd>\n                <br>`:""}\n                ${t.award?`<dt>Award</dt>\n                <dd>\n                    ${t.award}\n                </dd>\n                <br>`:""}\n                ${t.paper?`<dt>Paper</dt>\n                <dd>\n                    ${t.paper}\n                </dd>\n                <br>`:""}\n                ${t.grants?`<dt>Grants</dt>\n                <dd>\n                    ${t.grants}\n                </dd>\n                <br>`:""}\n                ${t.collaborators?`<dt>Co-create with</dt>\n                <dd>\n                    ${t.collaborators}\n                </dd>\n                <br>`:""}\n                ${t.download?`<dt>Download</dt>\n                <dd>\n                    ${t.download}\n                </dd>\n                <br>`:""}\n                ${t.citation?`<dt>Citation</dt>\n                <dd>\n                    ${t.citation}\n                </dd>\n                <br>`:""}\n                ${t.related?`<dt>Related</dt>\n                <dd>\n                    ${t.related}\n                </dd>\n                <br>`:""}\n                ${t.link?`<dt>Link</dt>\n                <dd>\n                    ${t.link}\n                </dd>\n                <br>`:""}\n                </dl>\n\n            </div>\n            <hr class="final-hr-1" style="opacity: 0;">\n            <hr class="final-hr-2" style="opacity: 0;">\n            <br>\n  `),n.appendChild(r);const a="glitch",s=r.querySelector(".work-title-animated"),l=r.querySelector(".work-year-animated"),c=r.querySelector(".work-category-animated");if(s&&setTimeout(()=>{animateTextTransition(s,t.title,a,800)},100),l&&setTimeout(()=>{animateTextTransition(l,t.year,a,600)},150),c){const e=t.category.charAt(0).toUpperCase()+t.category.slice(1);setTimeout(()=>{animateTextTransition(c,e,a,600)},200)}const d=r.querySelector(".swiper-container");d&&(d.style.transition="opacity 0.8s ease",setTimeout(()=>{d.style.opacity="1"},100));const m=r.querySelector(".work-content-animated"),u=r.querySelector("h3");m&&(m.style.opacity="0",u&&(u.style.opacity="0"),setTimeout(()=>{m.style.transition="opacity 0.3s ease",m.style.opacity="1";const t=m.querySelector("p"),e=m.querySelector("dl"),n=[];if(t&&n.push({element:t,type:"p"}),e){Array.from(e.children).forEach(t=>{"DT"!==t.tagName&&"DD"!==t.tagName||n.push({element:t,type:t.tagName.toLowerCase()})})}if(u){const t=u.textContent;u.textContent="",u.style.opacity="1";const e=performance.now(),n=1e3;requestAnimationFrame(function o(r){const i=r-e,a=Math.min(i/n,1),s=Math.floor(t.length*a);a<1?(u.textContent=t.substring(0,s)+"▌",requestAnimationFrame(o)):u.textContent=t})}n.forEach(({element:t})=>{t.style.opacity="0",t.style.transform="translateY(10px)",t.style.transition="opacity 0.4s ease, transform 0.4s ease"}),n.forEach(({element:t,type:e},n)=>{setTimeout(()=>{const e=document.createElement("span");e.className="typing-cursor-before",e.textContent="▌",e.style.cssText="opacity: 0; margin-right: 5px; color: #006DD9; animation: blink 0.8s step-start infinite;",t.parentNode.insertBefore(e,t),setTimeout(()=>{e.style.opacity="1"},50),setTimeout(()=>{t.style.opacity="1",t.style.transform="translateY(0)",setTimeout(()=>{e.style.opacity="0",setTimeout(()=>e.remove(),300)},400)},200)},150*n)});const o=r.querySelector(".final-hr-1"),i=r.querySelector(".final-hr-2");if(o&&i){o.style.opacity="0",i.style.opacity="0",o.style.transition="opacity 0.6s ease",i.style.transition="opacity 0.6s ease";const t=1e3,e=n.length>0?150*(n.length-1)+600:0,r=Math.max(t,e);setTimeout(()=>{o.style.opacity="1",setTimeout(()=>{i.style.opacity="1"},200)},r+300)}},900)),setTimeout(()=>{currentSwiper=new Swiper(".swiper-container",{loop:t.images.length>1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},keyboard:{enabled:!0}})},50),r.querySelector(".back-to-list").addEventListener("click",t=>{t.preventDefault(),window.location.hash=""}),window.scrollTo({top:0,behavior:"smooth"})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initWorksSPA):initWorksSPA();